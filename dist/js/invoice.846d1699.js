(function(e){function t(t){for(var i,l,o=t[0],r=t[1],c=t[2],d=0,v=[];d<o.length;d++)l=o[d],s[l]&&v.push(s[l][0]),s[l]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);u&&u(t);while(v.length)v.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],i=!0,o=1;o<a.length;o++){var r=a[o];0!==s[r]&&(i=!1)}i&&(n.splice(t--,1),e=l(l.s=a[0]))}return e}var i={},s={invoice:0},n=[];function l(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=e,l.c=i,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(a,i,function(t){return e[t]}.bind(null,i));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=r;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("0b53")},"0b53":function(e,t,a){"use strict";a.r(t);a("4d48");var i=a("d1e1"),s=(a("81e6"),a("9ffb")),n=(a("5852"),a("d961")),l=(a("09d3"),a("2d6d")),o=(a("61ae"),a("d314")),r=(a("ab71"),a("58e6")),c=(a("2994"),a("2bdd")),u=(a("537a"),a("ac28")),d=(a("a52c"),a("2ed4")),v=(a("66b9"),a("b650")),m=(a("c194"),a("7744")),p=(a("0653"),a("34e9")),f=(a("4467"),a("c36e")),h=(a("4662"),a("28a2")),b=(a("4056"),a("44bf")),g=(a("e7e5"),a("d399")),x=(a("ac1e"),a("543e")),O=(a("e17f"),a("2241")),J=(a("d1cf"),a("ee83")),k=(a("c3a6"),a("ad06")),w=(a("cadf"),a("551c"),a("f751"),a("097d"),a("2b0e")),y=a("bc3a"),T=a.n(y),$=a("a7fe"),_=a.n($),I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("keep-alive",{attrs:{include:["Home"]}},[a("router-view")],1)],1)},L=[],S={name:"app",components:{}},C=S,N=a("2877"),D=Object(N["a"])(C,I,L,!1,null,null,null),j=D.exports,P=a("8c4f"),U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("keep-alive",[a("router-view",{ref:"router"})],1),a("van-tabbar",{ref:"tabbar",attrs:{route:""},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[a("van-tabbar-item",{ref:"successListItem",attrs:{name:"successList",replace:"",to:"/successList",icon:"passed"}},[e._v("\n            识别成功\n        ")]),a("van-button",{staticClass:"add-invoice",staticStyle:{position:"relative",top:"11px",background:"#4486fc"},attrs:{icon:"plus",round:!0,size:"small"},on:{click:e.addInvoice}}),a("van-tabbar-item",{ref:"unsuccessListItem",attrs:{name:"unsuccessList",replace:"",to:"/unsuccessList",icon:"more-o"}},[e._v("\n            识别中/识别失败\n        ")])],1)],1)},A=[],R=(a("7f7f"),a("7514"),a("ac6a"),a("9a83"),a("f564"));w["a"].use(R["a"]);var E={name:"Home",data:function(){return{active:"successList"}},methods:{addInvoice:function(){var e=this,t=function(t){e.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"正在上传..."});var a=0,i=[],s={success:0,fail:0,processing:t.length};t.forEach(function(n){var l=!0;wx.uploadImage({localId:n,isShowProgressTips:!1,success:function(o){if(l){l=!1;var r=o.serverId,c=n.substr(n.lastIndexOf("/")+1);e.axios.post("./jd?sid="+sid+"&appId="+appId+"&cmd=com.actionsoft.apps.addons.invoice.UPLOAD_WX&fileName="+c+"&groupValue="+invoiceUserId+"&fileValue="+boItemName+"&serverId="+r).then(function(n){e.axios.post("./jd?sid="+sid+"&appId="+appId+"&cmd=com.actionsoft.apps.addons.invoice.recognizeInvoice&fileName="+c+"&groupValue="+invoiceUserId+"&fileValue="+boItemName).then(function(n){var l=n.data;if("ok"===l.result){var o=l.data.invoiceId;i.push(o)}if(a++,a===t.length){e.$toast.success("正在后台识别，您可以继续其他操作");var r=e.$refs.tabbar.$props.value;if("successList"===r){e.$refs.unsuccessListItem.$el.click();var c=e.$children.find(function(e){return"UnsuccessList"===e.$options.name});c&&e.$nextTick(function(){e.$refs.router.refresh()})}else"unsuccessList"===r&&e.$refs.router.refresh();var u=function t(){e.axios.post("./jd?sid="+sid+"&cmd=com.actionsoft.apps.addons.invoice.queryInvoiceResult&invoiceIdArrStr="+JSON.stringify(i)).then(function(a){var i=a.data;if("ok"===i.result)try{if(i.data.success===s.success&&i.data.fail===s.fail&&i.data.processing===s.processing);else{s.success=i.data.success,s.fail=i.data.fail,s.processing=i.data.processing;var n=i.data.success+i.data.fail+i.data.processing,l=3e3;i.data.processing,Object(R["a"])({message:"识别成功 "+i.data.success+"/"+n+"、识别失败 "+i.data.fail+"/"+n+"、识别中 "+i.data.processing+"/"+n,duration:l,background:"#ff5722"})}}catch(c){}if(0===i.data.processing){e.$refs.successListItem.$el.click();var o=e.$children.find(function(e){return"SuccessList"===e.$options.name});o.refresh();var r=e.$children.find(function(e){return"UnsuccessList"===e.$options.name});r.refresh()}else setTimeout(t,6e3)})};setTimeout(u,3e3)}})})}},error:function(){e.$toast.fail("上传到企业微信的请求出错")}})})};if("true"===isWeiXin){var a=!0;wx.chooseImage({count:9,sizeType:["original"],sourceType:["album","camera"],success:function(e){a&&(a=!1,t(e.localIds))}})}if("true"===isMobileApp)try{var i=function(){var e=document.URL,t="uf";e&&-1!=e.indexOf("/r/")&&(t=e.substring(0,e.indexOf("/r/"))+"/r/uf");var a=t+"?";return a},s=i()+"appId="+appId+"&sid="+sid+"&groupValue="+invoiceUserId+"&fileValue="+boItemName+"&repositoryName=invoice",n={success:"invoiceHome.mobileAppSuccessCallback",fail:"invoiceHome.mobileAppFailCallback",count:9,sizeType:["original"],sourceType:["album","camera"],SERVER:encodeURI(s)};awsWebview.chooseImage(n)}catch(l){alert(l)}},mobileAppSuccessCallback:function(e){var t=this,a=(this.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"正在上传..."}),0),i=[],s={success:0,fail:0,processing:e.length};e.forEach(function(n){t.axios.post("./jd?sid="+sid+"&appId="+appId+"&cmd=com.actionsoft.apps.addons.invoice.recognizeInvoice&fileName="+n.fileName+"&groupValue="+invoiceUserId+"&fileValue="+boItemName).then(function(n){var l=n.data;if("ok"===l.result){var o=l.data.invoiceId;i.push(o)}if(a++,a===e.length){t.$toast.success("正在后台识别，您可以继续其他操作");var r=t.$refs.tabbar.$props.value;if("successList"===r){t.$refs.unsuccessListItem.$el.click();var c=t.$children.find(function(e){return"UnsuccessList"===e.$options.name});c&&t.$nextTick(function(){t.$refs.router.refresh()})}else"unsuccessList"===r&&t.$refs.router.refresh();var u=function e(){t.axios.post("./jd?sid="+sid+"&cmd=com.actionsoft.apps.addons.invoice.queryInvoiceResult&invoiceIdArrStr="+JSON.stringify(i)).then(function(a){var i=a.data;if("ok"===i.result)try{if(i.data.success===s.success&&i.data.fail===s.fail&&i.data.processing===s.processing);else{s.success=i.data.success,s.fail=i.data.fail,s.processing=i.data.processing;var n=i.data.success+i.data.fail+i.data.processing,l=3e3;i.data.processing,Object(R["a"])({message:"识别成功 "+i.data.success+"/"+n+"、识别失败 "+i.data.fail+"/"+n+"、识别中 "+i.data.processing+"/"+n,duration:l,background:"#ff5722"})}}catch(c){}if(0===i.data.processing){t.$refs.successListItem.$el.click();var o=t.$children.find(function(e){return"SuccessList"===e.$options.name});o.refresh();var r=t.$children.find(function(e){return"UnsuccessList"===e.$options.name});r.refresh()}else setTimeout(e,6e3)})};setTimeout(u,3e3)}})})},mobileAppFailCallback:function(){this.$toast.fail("上传图片出错")}},mounted:function(){if(window.invoiceHome=this,this.$refs.successListItem.$el.click(),"true"===isWeiXin){var e="abc",t=Date.parse(new Date)+"";t=t.substring(0,10);var a=window.location.href;a=a.substring(0,a.indexOf("#"));var i="jsapi_ticket="+jsapi_ticket+"&noncestr="+e+"&timestamp="+t+"&url="+a,s=sha1(i);wx.config({beta:!0,debug:!1,appId:corpId,timestamp:t,nonceStr:e,signature:s,jsApiList:jsApiList}),wx.ready(function(){wx.hideMenuItems({menuList:["menuItem:share:timeline","menuItem:favorite","menuItem:share:appMessage","menuItem:openWithQQBrowser","menuItem:openWithSafari","menuItem:share:email","menuItem:share:wechat"]})}),wx.error(function(e){alert("微信注册信息验证失败，请联系管理员。校验结果为："+JSON.stringify(e))})}}},M=E,V=(a("3810"),Object(N["a"])(M,U,A,!1,null,"154521ee",null)),q=V.exports,z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[[i("div",{staticStyle:{position:"relative"}},[i("van-image",{directives:[{name:"show",rawName:"v-show",value:e.detailJO.imageUrl,expression:"detailJO.imageUrl"}],attrs:{fit:"contain",src:e.detailJO.imageUrl},on:{click:function(t){return e.preview()}}}),i("img",{directives:[{name:"show",rawName:"v-show",value:"invoice"===e.detailJO.ticketType||"train"===e.detailJO.ticketType||"plane"===e.detailJO.ticketType,expression:"detailJO.ticketType === 'invoice' || detailJO.ticketType === 'train' || detailJO.ticketType === 'plane'"}],staticClass:"authentic",attrs:{src:a("686a")}})],1),"invoice"===e.detailJO.ticketType?[i("van-cell-group",{attrs:{title:"开票内容"}},[i("van-cell",{attrs:{title:"发票代码"},model:{value:e.detailJO.invoiceCode,callback:function(t){e.$set(e.detailJO,"invoiceCode",t)},expression:"detailJO.invoiceCode"}}),i("van-cell",{attrs:{title:"发票号码"},model:{value:e.detailJO.invoiceNumber,callback:function(t){e.$set(e.detailJO,"invoiceNumber",t)},expression:"detailJO.invoiceNumber"}}),i("van-cell",{attrs:{title:"开票日期"},model:{value:e.detailJO.billingDate,callback:function(t){e.$set(e.detailJO,"billingDate",t)},expression:"detailJO.billingDate"}}),i("van-cell",{attrs:{title:"开票金额"},model:{value:e.detailJO.amount,callback:function(t){e.$set(e.detailJO,"amount",t)},expression:"detailJO.amount"}}),i("van-cell",{attrs:{title:"不含税额"},model:{value:e.detailJO.amountExcludeTax,callback:function(t){e.$set(e.detailJO,"amountExcludeTax",t)},expression:"detailJO.amountExcludeTax"}}),i("van-cell",{attrs:{title:"税额"},model:{value:e.detailJO.tax,callback:function(t){e.$set(e.detailJO,"tax",t)},expression:"detailJO.tax"}}),i("van-cell",{attrs:{title:"校验码"},model:{value:e.detailJO.checkCode,callback:function(t){e.$set(e.detailJO,"checkCode",t)},expression:"detailJO.checkCode"}})],1),i("van-cell-group",{attrs:{title:"开票方"}},[i("van-cell",{attrs:{title:"开票方"},model:{value:e.detailJO.sellerTaxName,callback:function(t){e.$set(e.detailJO,"sellerTaxName",t)},expression:"detailJO.sellerTaxName"}}),i("van-cell",{attrs:{title:"纳税人识别号"},model:{value:e.detailJO.sellerTaxNumber,callback:function(t){e.$set(e.detailJO,"sellerTaxNumber",t)},expression:"detailJO.sellerTaxNumber"}}),i("van-cell",{attrs:{title:"地址、电话"},model:{value:e.detailJO.sellerAddressPhone,callback:function(t){e.$set(e.detailJO,"sellerAddressPhone",t)},expression:"detailJO.sellerAddressPhone"}}),i("van-cell",{attrs:{title:"开户行账号"},model:{value:e.detailJO.sellerBankAccount,callback:function(t){e.$set(e.detailJO,"sellerBankAccount",t)},expression:"detailJO.sellerBankAccount"}})],1),i("van-cell-group",{attrs:{title:"收票方"}},[i("van-cell",{attrs:{title:"收票方"},model:{value:e.detailJO.buyerTaxName,callback:function(t){e.$set(e.detailJO,"buyerTaxName",t)},expression:"detailJO.buyerTaxName"}}),i("van-cell",{attrs:{title:"纳税人识别号"},model:{value:e.detailJO.buyerTaxNumber,callback:function(t){e.$set(e.detailJO,"buyerTaxNumber",t)},expression:"detailJO.buyerTaxNumber"}}),i("van-cell",{attrs:{title:"地址、电话"},model:{value:e.detailJO.buyerAddressPhone,callback:function(t){e.$set(e.detailJO,"buyerAddressPhone",t)},expression:"detailJO.buyerAddressPhone"}}),i("van-cell",{attrs:{title:"开户行账号"},model:{value:e.detailJO.buyerBankAccount,callback:function(t){e.$set(e.detailJO,"buyerBankAccount",t)},expression:"detailJO.buyerBankAccount"}})],1),i("van-cell-group",{attrs:{title:"项目列表"}},e._l(e.detailJO.goodsJA,function(t,a){return i("van-cell-group",{attrs:{title:"项目"+(a+1)}},[i("van-cell",{attrs:{title:"名称"},model:{value:t.goodsName,callback:function(a){e.$set(t,"goodsName",a)},expression:"goods.goodsName"}}),i("van-cell",{attrs:{title:"金额"},model:{value:t.amountExcludeTax,callback:function(a){e.$set(t,"amountExcludeTax",a)},expression:"goods.amountExcludeTax"}}),i("van-cell",{attrs:{title:"税率"},model:{value:t.taxRate,callback:function(a){e.$set(t,"taxRate",a)},expression:"goods.taxRate"}}),i("van-cell",{attrs:{title:"税额"},model:{value:t.tax,callback:function(a){e.$set(t,"tax",a)},expression:"goods.tax"}})],1)}),1)]:"train"===e.detailJO.ticketType?[i("van-cell",{attrs:{title:"姓名"},model:{value:e.detailJO.name,callback:function(t){e.$set(e.detailJO,"name",t)},expression:"detailJO.name"}}),i("van-cell",{attrs:{title:"金额"},model:{value:e.detailJO.amount,callback:function(t){e.$set(e.detailJO,"amount",t)},expression:"detailJO.amount"}}),i("van-cell",{attrs:{title:"开始时间"},model:{value:e.detailJO.startTime,callback:function(t){e.$set(e.detailJO,"startTime",t)},expression:"detailJO.startTime"}}),i("van-cell",{attrs:{title:"结束时间"},model:{value:e.detailJO.endTime,callback:function(t){e.$set(e.detailJO,"endTime",t)},expression:"detailJO.endTime"}}),i("van-cell",{attrs:{title:"开始地点"},model:{value:e.detailJO.startLocation,callback:function(t){e.$set(e.detailJO,"startLocation",t)},expression:"detailJO.startLocation"}}),i("van-cell",{attrs:{title:"结束地点"},model:{value:e.detailJO.endLocation,callback:function(t){e.$set(e.detailJO,"endLocation",t)},expression:"detailJO.endLocation"}}),i("van-cell",{attrs:{title:"车次"},model:{value:e.detailJO.trainNumber,callback:function(t){e.$set(e.detailJO,"trainNumber",t)},expression:"detailJO.trainNumber"}}),i("van-cell",{attrs:{title:"座位等级"},model:{value:e.detailJO.seatClass,callback:function(t){e.$set(e.detailJO,"seatClass",t)},expression:"detailJO.seatClass"}})]:"plane"===e.detailJO.ticketType?[i("van-cell",{attrs:{title:"姓名"},model:{value:e.detailJO.name,callback:function(t){e.$set(e.detailJO,"name",t)},expression:"detailJO.name"}}),i("van-cell",{attrs:{title:"金额"},model:{value:e.detailJO.amount,callback:function(t){e.$set(e.detailJO,"amount",t)},expression:"detailJO.amount"}}),i("van-cell",{attrs:{title:"开始时间"},model:{value:e.detailJO.startTime,callback:function(t){e.$set(e.detailJO,"startTime",t)},expression:"detailJO.startTime"}}),i("van-cell",{attrs:{title:"结束时间"},model:{value:e.detailJO.endTime,callback:function(t){e.$set(e.detailJO,"endTime",t)},expression:"detailJO.endTime"}}),i("van-cell",{attrs:{title:"开始地点"},model:{value:e.detailJO.startLocation,callback:function(t){e.$set(e.detailJO,"startLocation",t)},expression:"detailJO.startLocation"}}),i("van-cell",{attrs:{title:"结束地点"},model:{value:e.detailJO.endLocation,callback:function(t){e.$set(e.detailJO,"endLocation",t)},expression:"detailJO.endLocation"}}),i("van-cell",{attrs:{title:"客票代码"},model:{value:e.detailJO.planeCode,callback:function(t){e.$set(e.detailJO,"planeCode",t)},expression:"detailJO.planeCode"}}),i("van-cell",{attrs:{title:"航班号"},model:{value:e.detailJO.flightNumber,callback:function(t){e.$set(e.detailJO,"flightNumber",t)},expression:"detailJO.flightNumber"}}),i("van-cell",{attrs:{title:"承运人"},model:{value:e.detailJO.carrier,callback:function(t){e.$set(e.detailJO,"carrier",t)},expression:"detailJO.carrier"}}),i("van-cell",{attrs:{title:"座位等级"},model:{value:e.detailJO.seatClass,callback:function(t){e.$set(e.detailJO,"seatClass",t)},expression:"detailJO.seatClass"}}),i("van-cell",{attrs:{title:"客票序列号"},model:{value:e.detailJO.serialNumber,callback:function(t){e.$set(e.detailJO,"serialNumber",t)},expression:"detailJO.serialNumber"}})]:"manual"===e.detailJO.ticketType?[i("van-cell",{attrs:{title:"金额"},model:{value:e.detailJO.amount,callback:function(t){e.$set(e.detailJO,"amount",t)},expression:"detailJO.amount"}}),i("van-cell",{attrs:{title:"开票日期"},model:{value:e.detailJO.billingDate,callback:function(t){e.$set(e.detailJO,"billingDate",t)},expression:"detailJO.billingDate"}}),i("van-cell",{attrs:{title:"开始时间"},model:{value:e.detailJO.startTime,callback:function(t){e.$set(e.detailJO,"startTime",t)},expression:"detailJO.startTime"}}),i("van-cell",{attrs:{title:"结束时间"},model:{value:e.detailJO.endTime,callback:function(t){e.$set(e.detailJO,"endTime",t)},expression:"detailJO.endTime"}}),i("van-cell",{attrs:{title:"票据编号"},model:{value:e.detailJO.manualCode,callback:function(t){e.$set(e.detailJO,"manualCode",t)},expression:"detailJO.manualCode"}}),i("van-cell",{attrs:{title:"是否有章"},model:{value:e.detailJO.hasStamp,callback:function(t){e.$set(e.detailJO,"hasStamp",t)},expression:"detailJO.hasStamp"}}),i("van-cell",{attrs:{title:"备注信息"},model:{value:e.detailJO.memo,callback:function(t){e.$set(e.detailJO,"memo",t)},expression:"detailJO.memo"}})]:[i("van-row",{directives:[{name:"show",rawName:"v-show",value:!e.detailLoading,expression:"!detailLoading"}]},[i("van-col",{staticStyle:{"text-align":"center"},attrs:{span:"24"}},[e._v("类型错误，无法获取详细信息")])],1)]],i("van-loading",{directives:[{name:"show",rawName:"v-show",value:e.detailLoading,expression:"detailLoading"}],staticStyle:{width:"100%","text-align":"center",padding:"50px 0"},attrs:{color:"#1989fa"}},[e._v("加载中...")]),i("van-image-preview",{attrs:{images:e.previewImages,loop:!1},model:{value:e.showImagePreview,callback:function(t){e.showImagePreview=t},expression:"showImagePreview"}})],2)},B=[],F={name:"Detail",props:{},data:function(){return{detailLoading:!1,detailJO:{},showImagePreview:!1,previewImages:[]}},methods:{getDetail:function(){var e=this;this.detailLoading=!0,this.axios.get(mobileURL+"/r/jd?sid="+sid+"&cmd=com.actionsoft.apps.addons.invoice.getInvoiceDetail&invoiceId="+this.$route.query.invoiceId).then(function(t){e.detailLoading=!1;var a=t.data;"ok"===a.result?e.detailJO=a.data.jo:e.$toast.fail(a.msg)})},preview:function(){this.previewImages[0]=this.detailJO.imageUrl,this.showImagePreview=!0}},mounted:function(){this.getDetail()}},W=F,H=(a("3571"),Object(N["a"])(W,z,B,!1,null,"8a0503ca",null)),X=H.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{position:"relative","background-color":"#ebebeb"}},[a("van-row",{staticStyle:{"background-color":"#4386fc",color:"#ffffff",padding:"10px 10px 5px","font-size":"16px"}},[a("van-col",{attrs:{span:"18"}},[e._v("总金额")]),a("van-col",{attrs:{span:"6"}},[e._v("张数")])],1),a("van-row",{staticStyle:{"background-color":"#4386fc",color:"#ffffff",padding:"10px 10px 30px"}},[a("van-col",{staticStyle:{"font-size":"28px","font-weight":"bold"},attrs:{span:"18"}},[e._v("\n            ￥"+e._s(this.sumWithCommas)+"\n        ")]),a("van-col",{staticStyle:{"padding-top":"10px"},attrs:{span:"6"}},[e._v(e._s(this.count))])],1),a("form",{attrs:{action:"/"}},[a("van-search",{attrs:{placeholder:"搜索"},on:{search:e.reloadList},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),a("van-dropdown-menu",[a("van-dropdown-item",{attrs:{options:e.invoiceTypeOptions},on:{change:e.reloadList},model:{value:e.invoiceType,callback:function(t){e.invoiceType=t},expression:"invoiceType"}}),a("van-dropdown-item",{attrs:{options:e.reimburseStatusOptions},on:{change:e.reloadList},model:{value:e.reimburseStatus,callback:function(t){e.reimburseStatus=t},expression:"reimburseStatus"}}),a("van-dropdown-item",{ref:"invoiceDateDropdownItem",attrs:{title:e.currentDateTitle}},[a("van-datetime-picker",{attrs:{type:"year-month","min-date":e.minDate,"max-date":e.maxDate,formatter:e.yearMonthFormatter,"show-toolbar":!0,"cancel-button-text":"清除"},on:{confirm:e.confirm,cancel:e.cancel},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1)],1),a("van-pull-refresh",{on:{refresh:e.refresh},model:{value:e.refreshLoading,callback:function(t){e.refreshLoading=t},expression:"refreshLoading"}},[a("van-list",{staticStyle:{"min-height":"calc(100vh - 271px)"},attrs:{finished:e.finished,"finished-text":"没有更多了","error-text":"加载出错"},on:{load:e.loadList},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[a("ul",e._l(e.list,function(t,i){return a("li",{key:t.id},[a("router-link",{attrs:{to:{path:"./detail",query:{invoiceId:t.id}},append:""}},[a("van-swipe-cell",{staticClass:"my-swipe-cell"},["invoice"===t.ticketType?[a("div",{staticClass:"invoice-item"},[a("van-row",[a("van-col",{attrs:{span:"18"}},[a("van-row",[a("van-col",{staticClass:"buyerTaxName",attrs:{span:"24"}},[e._v(" 付款方: "+e._s(t.buyerTaxName))])],1),a("van-row",{staticStyle:{margin:"10px 0"}},[a("van-col",{staticClass:"sellerTaxName",attrs:{span:"24"}},[e._v(e._s(t.sellerTaxName))])],1)],1),a("van-col",{staticClass:"amount",attrs:{span:"6"}},[e._v("\n                                            ￥"+e._s(t.amount)+"\n                                        ")])],1),a("van-row",[a("van-col",{staticClass:"invoiceType",attrs:{span:"6"}},[e._v("发票")]),a("van-col",{staticClass:"billingDate",attrs:{span:"12"}},[e._v(e._s(t.billingDate))]),a("van-col",{class:"reimburseStatus "+t.reimburseStatus,attrs:{span:"6"}},["unused"===t.reimburseStatus?[e._v("\n                                                可报销\n                                            ")]:"using"===t.reimburseStatus?[e._v("\n                                                报销中\n                                            ")]:"used"===t.reimburseStatus?[e._v("\n                                                已报销\n                                            ")]:e._e()],2)],1)],1)]:"train"===t.ticketType?[a("div",{staticClass:"invoice-item"},[a("van-row",[a("van-col",{attrs:{span:"18"}},[a("van-row",[a("van-col",{staticClass:"name",attrs:{span:"24"}},[e._v(" "+e._s(t.name))])],1),a("van-row",{staticStyle:{margin:"10px 0"}},[a("van-col",{staticClass:"trainNumber",attrs:{span:"24"}},[e._v(e._s(t.trainNumber)+" "+e._s(t.startLocation)+" - "+e._s(t.endLocation)+"\n                                                ")])],1),a("van-row",{staticStyle:{margin:"10px 0"}},[a("van-col",{staticClass:"time",attrs:{span:"24"}},[e._v(e._s(t.startTime)),a("br"),e._v(e._s(t.endTime))])],1)],1),a("van-col",{staticClass:"amount",attrs:{span:"6"}},[e._v("￥"+e._s(t.amount))])],1),a("van-row",[a("van-col",{staticClass:"invoiceType",attrs:{span:"6"}},[e._v("火车票")]),a("van-col",{staticClass:"billingDate",attrs:{span:"12"}},[e._v(e._s(t.billingDate))]),a("van-col",{class:"reimburseStatus "+t.reimburseStatus,attrs:{span:"6"}},["unused"===t.reimburseStatus?[e._v("\n                                                可报销\n                                            ")]:"using"===t.reimburseStatus?[e._v("\n                                                报销中\n                                            ")]:"used"===t.reimburseStatus?[e._v("\n                                                已报销\n                                            ")]:e._e()],2)],1)],1)]:"plane"===t.ticketType?[a("div",{staticClass:"invoice-item"},[a("van-row",[a("van-col",{attrs:{span:"18"}},[a("van-row",[a("van-col",{staticClass:"name",attrs:{span:"24"}},[e._v(" "+e._s(t.name))])],1),a("van-row",{staticStyle:{margin:"10px 0"}},[a("van-col",{staticClass:"flightNumber",attrs:{span:"24"}},[e._v(e._s(t.flightNumber)+" "+e._s(t.startLocation)+" - "+e._s(t.endLocation)+"\n                                                ")])],1),a("van-row",{staticStyle:{margin:"10px 0"}},[a("van-col",{staticClass:"time",attrs:{span:"24"}},[e._v(e._s(t.startTime)),a("br"),e._v(e._s(t.endTime))])],1)],1),a("van-col",{staticClass:"amount",attrs:{span:"6"}},[e._v("￥"+e._s(t.amount))])],1),a("van-row",[a("van-col",{staticClass:"invoiceType",attrs:{span:"6"}},[e._v("飞机票")]),a("van-col",{staticClass:"billingDate",attrs:{span:"12"}},[e._v(e._s(t.billingDate))]),a("van-col",{class:"reimburseStatus "+t.reimburseStatus,attrs:{span:"6"}},["unused"===t.reimburseStatus?[e._v("\n                                                可报销\n                                            ")]:"using"===t.reimburseStatus?[e._v("\n                                                报销中\n                                            ")]:"used"===t.reimburseStatus?[e._v("\n                                                已报销\n                                            ")]:e._e()],2)],1)],1)]:"manual"===t.ticketType?[a("div",{staticClass:"invoice-item"},[a("van-row",[a("van-col",{attrs:{span:"18"}},[e._v("\n                                            "+e._s(t.memo)+"\n                                        ")]),a("van-col",{staticClass:"amount",attrs:{span:"6"}},[e._v("￥"+e._s(t.amount))])],1),a("van-row",[a("van-col",{staticClass:"invoiceType",attrs:{span:"6"}},[e._v("其他票")]),a("van-col",{staticClass:"billingDate",attrs:{span:"12"}},[e._v(e._s(t.billingDate))]),a("van-col",{class:"reimburseStatus "+t.reimburseStatus,attrs:{span:"6"}},["unused"===t.reimburseStatus?[e._v("\n                                                可报销\n                                            ")]:"using"===t.reimburseStatus?[e._v("\n                                                报销中\n                                            ")]:"used"===t.reimburseStatus?[e._v("\n                                                已报销\n                                            ")]:e._e()],2)],1)],1)]:e._e(),a("van-button",{attrs:{slot:"right",square:"",type:"danger",text:"删除"},on:{click:function(a){return a.preventDefault(),e.removeInvoice(t.id,i)}},slot:"right"})],2)],1)],1)}),0)])],1)],1)},Q=[],Z=(a("6b54"),a("a481"),a("75fc")),G={name:"SuccessList",data:function(){return{keyword:"",list:[],loading:!1,finished:!1,error:!1,rowCount:10,invoiceType:"",invoiceTypeOptions:[{text:"全部类型",value:"",icon:"http://localhost:8078/portal/console/images/logo.png"},{text:"发票",value:"invoice",icon:"https://b.yzcdn.cn/vant/icon-demo-1126.png"},{text:"火车票",value:"train",icon:"like-o"},{text:"飞机票",value:"plane",icon:"like-o"},{text:"其他",value:"manual",icon:"like-o"}],reimburseStatus:"",reimburseStatusOptions:[{text:"全部状态",value:""},{text:"可报销",value:"unused"},{text:"报销中",value:"using"},{text:"已报销",value:"used"}],currentDate:new Date,currentDateTitle:"日期",minDate:new Date(2016,12,30),maxDate:new Date,startTime:"",endTime:"",sum:0,count:0,refreshLoading:!1}},methods:{loadList:function(){var e=this,t=mobileURL+"/r/jd?sid="+sid+"&cmd=com.actionsoft.apps.addons.invoice.queryInvoiceList&skip="+this.list.length+"&rowCount=10&invoiceType="+this.invoiceType+"&reimburseStatus="+this.reimburseStatus+"&startTime="+this.startTime+"&endTime="+this.endTime+"&keyword="+this.keyword;this.axios.get(t).then(function(t){var a,i=t.data;"ok"===i.result?(i.data.hasOwnProperty("sum")&&(e.sum=i.data.sum,e.count=i.data.count),(a=e.list).push.apply(a,Object(Z["a"])(i.data.list)),e.loading=!1,0===i.data.list.length&&(e.finished=!0)):e.error=!0;e.refreshLoading=!1})},reloadList:function(){this.list=[],this.loading=!0,this.finished=!1,this.loadList()},yearMonthFormatter:function(e,t){return"year"===e?"".concat(t,"年"):"month"===e?"".concat(t,"月"):t},cancel:function(){this.currentDateTitle="不限时间",this.startTime="",this.endTime="",this.$refs.invoiceDateDropdownItem.toggle(),this.reloadList()},confirm:function(e){this.currentDateTitle=e.getFullYear()+"年"+(e.getMonth()+1)+"月",this.startTime=e.getFullYear()+"-"+(e.getMonth()+1)+"-1 00:00:00",this.endTime=e.getFullYear()+"-"+(e.getMonth()+1)+"-31 23:59:59",this.$refs.invoiceDateDropdownItem.toggle(),this.reloadList()},removeInvoice:function(e,t){var a=this,i=this.list[t];"used"===i.reimburseStatus?this.$toast.fail("该票据已经报销，不允许删除"):"using"===i.reimburseStatus?this.$toast.fail("该票据正在报销，不允许删除"):this.$dialog.confirm({title:"请确认",message:"确认删除该票据吗"}).then(function(){a.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"正在删除..."});var i=mobileURL+"/r/jd?sid="+sid+"&cmd=com.actionsoft.apps.addons.invoice.removeInvoice&invoiceId="+e;a.axios.get(i).then(function(e){var i=e.data;if("ok"===i.result){a.$toast.success("删除成功");var s=a.list[t];a.list.splice(t,1),a.sum-=s.amount,a.sum=a.sum.toFixed(2),a.count-=1}else a.$toast.fail(i.msg)})}).catch(function(){})},refresh:function(){this.reloadList()}},computed:{sumWithCommas:function(){return this.sum.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},watch:{},mounted:function(){}},K=G,ee=(a("664c"),Object(N["a"])(K,Y,Q,!1,null,"40f9bf8c",null)),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"background-color":"#ebebeb"}},[a("van-pull-refresh",{on:{refresh:e.refresh},model:{value:e.refreshLoading,callback:function(t){e.refreshLoading=t},expression:"refreshLoading"}},[a("van-list",{staticStyle:{"min-height":"calc(100vh - 50px)"},attrs:{finished:e.finished,"finished-text":"没有更多了","error-text":"加载出错"},on:{load:e.loadList},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[a("ul",e._l(e.list,function(t,i){return a("li",{key:t.id},[a("van-swipe-cell",{staticClass:"my-swipe-cell"},[a("div",{staticClass:"invoice-item"},[a("div",{staticClass:"parent"},[a("div",{staticClass:"left"},[a("van-image",{attrs:{width:"100",height:"100",src:t.imageZoomUrl,fit:"contain"},on:{click:function(t){return e.preview(i)}}})],1),a("div",{staticClass:"right"},["success"===t.resultStatus?[a("van-cell",{attrs:{title:"状态",value:"识别成功"}})]:"success_exist"===t.resultStatus?[a("van-cell",{attrs:{title:"状态",value:"该票据已经存在"}})]:"fail"===t.resultStatus?[a("van-cell",{attrs:{title:"状态",value:"识别失败"}})]:"processing"===t.resultStatus?[a("van-cell",{attrs:{title:"状态",value:"识别中"}})]:[a("van-cell",{attrs:{title:"状态",value:"状态错误"}})],a("van-cell",{attrs:{title:"创建时间"},model:{value:t.createTime,callback:function(a){e.$set(t,"createTime",a)},expression:"item.createTime"}}),"fail"===t.resultStatus?a("van-cell",{attrs:{title:"失败原因"},model:{value:t.failReason,callback:function(a){e.$set(t,"failReason",a)},expression:"item.failReason"}}):e._e()],2)])]),a("van-button",{attrs:{slot:"right",square:"",type:"danger",text:"删除"},on:{click:function(a){return a.preventDefault(),e.removeInvoice(t.id,i)}},slot:"right"})],1)],1)}),0)])],1),a("van-image-preview",{attrs:{images:e.previewImages,loop:!1,"show-indicators":!1,"start-position":e.currentIndex},model:{value:e.showImagePreview,callback:function(t){e.showImagePreview=t},expression:"showImagePreview"}})],1)},ie=[],se={name:"UnsuccessList",data:function(){return{list:[],loading:!1,finished:!1,error:!1,rowCount:10,showImagePreview:!1,previewImages:[],currentIndex:0,refreshLoading:!1}},methods:{loadList:function(){var e=this,t=mobileURL+"/r/jd?sid="+sid+"&cmd=com.actionsoft.apps.addons.invoice.queryUnsuccessInvoiceList&skip="+this.list.length+"&rowCount=10";this.axios.get(t).then(function(t){var a,i,s=t.data;"ok"===s.result?((a=e.list).push.apply(a,Object(Z["a"])(s.data.list)),(i=e.previewImages).push.apply(i,Object(Z["a"])(s.data.list.map(function(e){return e.imageUrl}))),e.loading=!1,0===s.data.list.length&&(e.finished=!0)):e.error=!0;e.refreshLoading=!1})},reloadList:function(){this.list=[],this.loading=!0,this.finished=!1,this.loadList()},preview:function(e){this.showImagePreview=!0,this.currentIndex=e},refresh:function(){this.previewImages=[],this.reloadList()},removeInvoice:function(e,t){var a=this;this.$dialog.confirm({title:"请确认",message:"确认删除该票据吗"}).then(function(){a.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"正在删除..."});var i=mobileURL+"/r/jd?sid="+sid+"&cmd=com.actionsoft.apps.addons.invoice.removeInvoice&invoiceId="+e;a.axios.get(i).then(function(e){var i=e.data;if("ok"===i.result){a.$toast.success("删除成功");a.list[t];a.list.splice(t,1)}else a.$toast.fail(i.msg)})}).catch(function(){})}}},ne=se,le=(a("6004"),Object(N["a"])(ne,ae,ie,!1,null,"b7776b0e",null)),oe=le.exports;w["a"].use(k["a"]),w["a"].use(m["a"]).use(p["a"]).use(f["a"]).use(h["a"]).use(b["a"]).use(g["a"]).use(x["a"]).use(O["a"]).use(J["a"]),w["a"].use(i["a"]).use(s["a"]).use(n["a"]).use(l["a"]).use(o["a"]).use(r["a"]).use(c["a"]).use(u["a"]).use(d["a"]).use(v["a"]),w["a"].use(P["a"]),w["a"].use(_.a,T.a),w["a"].config.productionTip=!1;var re=new P["a"]({routes:[{path:"/",component:q,children:[{path:"/successList",component:te},{path:"/unsuccessList",component:oe}]},{path:"/successList/detail",component:X}]});new w["a"]({render:function(e){return e(j)},router:re}).$mount("#app")},"10a5":function(e,t,a){},3571:function(e,t,a){"use strict";var i=a("10a5"),s=a.n(i);s.a},3810:function(e,t,a){"use strict";var i=a("eddc"),s=a.n(i);s.a},6004:function(e,t,a){"use strict";var i=a("ed35"),s=a.n(i);s.a},"664c":function(e,t,a){"use strict";var i=a("6cad"),s=a.n(i);s.a},"686a":function(e,t,a){e.exports=a.p+"img/authentic.b7eaa41a.png"},"6cad":function(e,t,a){},ed35:function(e,t,a){},eddc:function(e,t,a){}});
//# sourceMappingURL=invoice.846d1699.js.map